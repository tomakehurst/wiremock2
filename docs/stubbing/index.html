

<!doctype html>
<html lang="en" class="no-js">
  <head>
    

<meta charset="utf-8">



<!-- begin SEO -->









<title>Stubbing - WireMock</title>







<meta name="description" content="Returning stubbed HTTP responses to specific requests.">

<meta property="og:locale" content="en-US">
<meta property="og:site_name" content="WireMock">
<meta property="og:title" content="Stubbing">


  <link rel="canonical" href="http://tomakehurst.com/wiremock2/docs/stubbing/">
  <meta property="og:url" content="http://tomakehurst.com/wiremock2/docs/stubbing/">



  <meta property="og:description" content="Returning stubbed HTTP responses to specific requests.">





  

  





  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2016-06-29T14:25:53+01:00">
  
    <link rel="next" href="http://tomakehurst.com/wiremock2/docs/verifying/" title="Verifying">
  
  
    <link rel="prev" href="http://tomakehurst.com/wiremock2/docs/stateful-behaviour/" title="Stateful Behaviour">
  





  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Person",
      "name" : "Tom Akehurst",
      "url" : "http://tomakehurst.com/wiremock2",
      "sameAs" : null
    }
  </script>






<!-- end SEO -->


<link href="http://tomakehurst.com/wiremock2/feed.xml" type="application/atom+xml" rel="alternate" title="WireMock Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<link href="https://fonts.googleapis.com/css?family=Lato|Source+Code+Pro" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=McLaren" rel="stylesheet">

<!-- For all browsers -->
<link rel="stylesheet" href="http://tomakehurst.com/wiremock2/assets/css/main.css">

<meta http-equiv="cleartype" content="on">

    <!-- start custom head snippets -->

<!-- insert favicons. use http://realfavicongenerator.net/ -->

<!-- end custom head snippets -->
  </head>

  <body>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <button><div class="navicon"></div></button>
        <ul class="visible-links">
          <li class="masthead__menu-item masthead__menu-item--lg"><a href="http://tomakehurst.com/wiremock2/">WireMock</a></li>
          
            

            
            <li class="masthead__menu-item"><a href="http://tomakehurst.com/wiremock2/docs">Docs</a></li>
            

          
            

            
            <li class="masthead__menu-item"><a href="http://tomakehurst.com/wiremock2/blog">Blog</a></li>
            

          
            

            
            <li class="masthead__menu-item"><a href="http://tomakehurst.com/wiremock2/about">About</a></li>
            

          
            

            
            <li class="masthead__menu-item"><a href="https://github.com/tomakehurst/wiremock" target="_blank">GitHub</a></li>
            

          
            

            
            <li class="masthead__menu-item"><a href="https://groups.google.com/forum/#!forum/wiremock-user" target="_blank">Mailing List</a></li>
            

          
            

            
            <li class="masthead__menu-item"><a href="http://get.mocklab.io" target="_blank">MockLab</a></li>
            

          
        </ul>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    

<div id="main" role="main">
  


<div class="sidebar sticky">
  <nav class="nav__list">

    <ul>
      

      
      <li>
        <a href="/docs/getting-started/">

        Getting Started
      </a>
      
      <li>
        <a href="/docs/junit-rule/">

        The JUnit 4.x Rule
      </a>
      
      <li>
        <a href="/docs/java-usage/">

        Java (Non-JUnit) Usage
      </a>
      
      <li>
        <a href="/docs/running-standalone/">

        Running as a Standalone Process
      </a>
      
      <li>
        <a href="/docs/stubbing/" class="nav__list-item--selected">
        

        Stubbing
      </a>
      
      <li>
        <a href="/docs/verifying/">

        Verifying
      </a>
      
      <li>
        <a href="/docs/proxying/">

        Proxying
      </a>
      
      <li>
        <a href="/docs/record-playback/">

        Record and Playback
      </a>
      
      <li>
        <a href="/docs/simulating-faults/">

        Simulating Faults
      </a>
      
      <li>
        <a href="/docs/stateful-behaviour/">

        Stateful Behaviour
      </a>
      
      <li>
        <a href="/docs/https/">

        HTTPS
      </a>
      
      <li>
        <a href="/docs/extending-wiremock/">

        Extending WireMock
      </a>
      
    </ul>
  </nav>
</div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="Stubbing">
    <meta itemprop="description" content="A core feature of WireMock is the ability to return canned HTTPresponses for requests matching criteria. These criteria can be definedin terms of URL, headers and body content.">
    <meta itemprop="datePublished" content="June 29, 2016">
    

    <div class="page__inner-wrap">
      <header>
        <h1 class="page__title" itemprop="headline">Stubbing
</h1>
      </header>

      <section class="page__content" itemprop="text">
        <p>A core feature of WireMock is the ability to return canned HTTP
responses for requests matching criteria. These criteria can be defined
in terms of URL, headers and body content.</p>

<h2 id="basic-stubbing">Basic stubbing</h2>

<p>The following code will configure a response with a status of 200 to be
returned when the relative URL exactly matches <code class="highlighter-rouge">/some/thing</code> (including
query parameters). The body of the response will be “Hello world!” and a
<code class="highlighter-rouge">Content-Type</code> header will be sent with a value of <code class="highlighter-rouge">text-plain</code>.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">exactUrlOnly</span><span class="p">(</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">stubFor</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">"/some/thing"</span><span class="o">))</span>
            <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">()</span>
                <span class="o">.</span><span class="na">withHeader</span><span class="o">(</span><span class="s">"Content-Type"</span><span class="o">,</span> <span class="s">"text/plain"</span><span class="o">)</span>
                <span class="o">.</span><span class="na">withBody</span><span class="o">(</span><span class="s">"Hello world!"</span><span class="o">)));</span>

    <span class="n">assertThat</span><span class="o">(</span><span class="n">testClient</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"/some/thing"</span><span class="o">).</span><span class="na">statusCode</span><span class="o">(),</span> <span class="n">is</span><span class="o">(</span><span class="mi">200</span><span class="o">));</span>
    <span class="n">assertThat</span><span class="o">(</span><span class="n">testClient</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"/some/thing/else"</span><span class="o">).</span><span class="na">statusCode</span><span class="o">(),</span> <span class="n">is</span><span class="o">(</span><span class="mi">404</span><span class="o">));</span>
<span class="o">}</span>
</code></pre>
</div>

<blockquote>
  <p><strong>note</strong></p>

  <p>If you’d prefer to use slightly more BDDish language in your tests you
can replace <code class="highlighter-rouge">stubFor</code> with <code class="highlighter-rouge">givenThat</code>.</p>
</blockquote>

<p>To create the stub described above via the JSON API, the following
document can either be posted to
<code class="highlighter-rouge">http://&lt;host&gt;:&lt;port&gt;/__admin/mappings/new</code> or placed in a file with a
<code class="highlighter-rouge">.json</code> extension under the <code class="highlighter-rouge">mappings</code> directory:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span>
    <span class="s2">"request"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"method"</span><span class="err">:</span> <span class="s2">"GET"</span><span class="p">,</span>
        <span class="s2">"url"</span><span class="err">:</span> <span class="s2">"/some/thing"</span>
    <span class="p">},</span>
    <span class="s2">"response"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"status"</span><span class="err">:</span> <span class="mi">200</span><span class="p">,</span>
        <span class="s2">"body"</span><span class="err">:</span> <span class="s2">"Hello world!"</span><span class="p">,</span>
        <span class="s2">"headers"</span><span class="err">:</span> <span class="p">{</span>
            <span class="s2">"Content-Type"</span><span class="err">:</span> <span class="s2">"text/plain"</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>  <span class="nd">@Test</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="n">exactUrlOnly</span><span class="o">()</span> <span class="o">{</span>
      <span class="n">stubFor</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">"/some/thing"</span><span class="o">))</span>
              <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">()</span>
                  <span class="o">.</span><span class="na">withHeader</span><span class="o">(</span><span class="s">"Content-Type"</span><span class="o">,</span> <span class="s">"text/plain"</span><span class="o">)</span>
                  <span class="o">.</span><span class="na">withBody</span><span class="o">(</span><span class="s">"Hello world!"</span><span class="o">)));</span>

      <span class="n">assertThat</span><span class="o">(</span><span class="n">testClient</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"/some/thing"</span><span class="o">).</span><span class="na">statusCode</span><span class="o">(),</span> <span class="n">is</span><span class="o">(</span><span class="mi">200</span><span class="o">));</span>
      <span class="n">assertThat</span><span class="o">(</span><span class="n">testClient</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"/some/thing/else"</span><span class="o">).</span><span class="na">statusCode</span><span class="o">(),</span> <span class="n">is</span><span class="o">(</span><span class="mi">404</span><span class="o">));</span>
  <span class="o">}</span>
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code>  <span class="p">{</span>
      <span class="s2">"request"</span><span class="err">:</span> <span class="p">{</span>
          <span class="s2">"method"</span><span class="err">:</span> <span class="s2">"GET"</span><span class="p">,</span>
          <span class="s2">"url"</span><span class="err">:</span> <span class="s2">"/some/thing"</span>
      <span class="p">},</span>
      <span class="s2">"response"</span><span class="err">:</span> <span class="p">{</span>
          <span class="s2">"status"</span><span class="err">:</span> <span class="mi">200</span><span class="p">,</span>
          <span class="s2">"body"</span><span class="err">:</span> <span class="s2">"Hello world!"</span><span class="p">,</span>
          <span class="s2">"headers"</span><span class="err">:</span> <span class="p">{</span>
              <span class="s2">"Content-Type"</span><span class="err">:</span> <span class="s2">"text/plain"</span>
          <span class="p">}</span>
      <span class="p">}</span>
  <span class="p">}</span>
</code></pre>
</div>

<p>HTTP methods currently supported are:
<code class="highlighter-rouge">GET, POST, PUT, DELETE, HEAD, TRACE, OPTIONS</code>. You can specify <code class="highlighter-rouge">ANY</code> if
you want the stub mapping to match on any request method.</p>

<h3 id="setting-the-response-status-message">Setting the response status message</h3>

<p>In addition to the status code, the status message can optionally also
be set:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">statusMessage</span><span class="p">(</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">stubFor</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">"/some/thing"</span><span class="o">))</span>
            <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">()</span>
                <span class="o">.</span><span class="na">withStatus</span><span class="o">(</span><span class="mi">200</span><span class="o">)</span>
                <span class="o">.</span><span class="na">withStatusMessage</span><span class="o">(</span><span class="s">"Everything was just fine!"</span><span class="o">)</span>
                <span class="o">.</span><span class="na">withHeader</span><span class="o">(</span><span class="s">"Content-Type"</span><span class="o">,</span> <span class="s">"text/plain"</span><span class="o">)));</span>

    <span class="n">assertThat</span><span class="o">(</span><span class="n">testClient</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"/some/thing"</span><span class="o">).</span><span class="na">statusCode</span><span class="o">(),</span> <span class="n">is</span><span class="o">(</span><span class="mi">200</span><span class="o">));</span>
    <span class="n">assertThat</span><span class="o">(</span><span class="n">testClient</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"/some/thing/else"</span><span class="o">).</span><span class="na">statusCode</span><span class="o">(),</span> <span class="n">is</span><span class="o">(</span><span class="mi">404</span><span class="o">));</span>
<span class="o">}</span>
</code></pre>
</div>

<p>Or</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span>
    <span class="s2">"request"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"method"</span><span class="err">:</span> <span class="s2">"GET"</span><span class="p">,</span>
        <span class="s2">"url"</span><span class="err">:</span> <span class="s2">"/some/thing"</span>
    <span class="p">},</span>
    <span class="s2">"response"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"status"</span><span class="err">:</span> <span class="mi">200</span><span class="p">,</span>
        <span class="s2">"statusMessage"</span><span class="err">:</span> <span class="s2">"Everything was just fine!"</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<h2 id="url-matching">URL matching</h2>

<p>Entire URLs can be matched exactly (as in the example above) or via a
regular expression. In Java this is done with the <code class="highlighter-rouge">urlMatching()</code>
function:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">stubFor</span><span class="o">(</span><span class="n">put</span><span class="o">(</span><span class="n">urlMatching</span><span class="o">(</span><span class="s">"/thing/matching/[0-9]+"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">().</span><span class="na">withStatus</span><span class="o">(</span><span class="mi">200</span><span class="o">)));</span>
</code></pre>
</div>

<p>And in JSON via the <code class="highlighter-rouge">urlPattern</code> attribute:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span>
    <span class="s2">"request"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"method"</span><span class="err">:</span> <span class="s2">"PUT"</span><span class="p">,</span>
        <span class="s2">"urlPattern"</span><span class="err">:</span> <span class="s2">"/thing/matching/[0-9]+"</span>
    <span class="p">},</span>
    <span class="s2">"response"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"status"</span><span class="err">:</span> <span class="mi">200</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Alternatively, just the path part of the URL can be matched exactly or
using a regular expression, which is most useful when combined with
query parameter matching:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">stubFor</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="n">urlPathEqualTo</span><span class="o">(</span><span class="s">"/query"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">withQueryParam</span><span class="o">(</span><span class="s">"one"</span><span class="o">,</span> <span class="n">equalTo</span><span class="o">(</span><span class="s">"111"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">().</span><span class="na">withStatus</span><span class="o">(</span><span class="mi">200</span><span class="o">)));</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">stubFor</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="n">urlPathMatching</span><span class="o">(</span><span class="s">"/qu.*"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">withQueryParam</span><span class="o">(</span><span class="s">"one"</span><span class="o">,</span> <span class="n">equalTo</span><span class="o">(</span><span class="s">"111"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">().</span><span class="na">withStatus</span><span class="o">(</span><span class="mi">200</span><span class="o">)));</span>
</code></pre>
</div>

<p>And in JSON via the <code class="highlighter-rouge">urlPath</code> attribute:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span>
    <span class="s2">"request"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"method"</span><span class="err">:</span> <span class="s2">"GET"</span><span class="p">,</span>
        <span class="s2">"urlPath"</span><span class="err">:</span> <span class="s2">"/query"</span>
    <span class="p">},</span>
    <span class="s2">"response"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"status"</span><span class="err">:</span> <span class="mi">200</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<h2 id="request-header-matching">Request header matching</h2>

<p>To match stubs according to request headers:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">stubFor</span><span class="o">(</span><span class="n">post</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">"/with/headers"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">withHeader</span><span class="o">(</span><span class="s">"Content-Type"</span><span class="o">,</span> <span class="n">equalTo</span><span class="o">(</span><span class="s">"text/xml"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">withHeader</span><span class="o">(</span><span class="s">"Accept"</span><span class="o">,</span> <span class="n">matching</span><span class="o">(</span><span class="s">"text/.*"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">withHeader</span><span class="o">(</span><span class="s">"etag"</span><span class="o">,</span> <span class="n">notMatching</span><span class="o">(</span><span class="s">"abcd.*"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">withHeader</span><span class="o">(</span><span class="s">"X-Custom-Header"</span><span class="o">,</span> <span class="n">containing</span><span class="o">(</span><span class="s">"2134"</span><span class="o">))</span>
        <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">().</span><span class="na">withStatus</span><span class="o">(</span><span class="mi">200</span><span class="o">)));</span>
</code></pre>
</div>

<p>Or</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span>
    <span class="s2">"request"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"method"</span><span class="err">:</span> <span class="s2">"POST"</span><span class="p">,</span>
        <span class="s2">"url"</span><span class="err">:</span> <span class="s2">"/with/headers"</span><span class="p">,</span>
        <span class="s2">"headers"</span><span class="err">:</span> <span class="p">{</span>
            <span class="s2">"Content-Type"</span><span class="err">:</span> <span class="p">{</span>
                <span class="s2">"equalTo"</span><span class="err">:</span> <span class="s2">"text/xml"</span>
            <span class="p">},</span>
            <span class="s2">"Accept"</span><span class="err">:</span> <span class="p">{</span>
                <span class="s2">"matches"</span><span class="err">:</span> <span class="s2">"text/.*"</span>
            <span class="p">},</span>
            <span class="s2">"etag"</span><span class="err">:</span> <span class="p">{</span>
                <span class="s2">"doesNotMatch"</span><span class="err">:</span> <span class="s2">"abcd.*"</span>
            <span class="p">},</span>
            <span class="s2">"X-Custom-Header"</span><span class="err">:</span> <span class="p">{</span>
                <span class="s2">"contains"</span><span class="err">:</span> <span class="s2">"2134"</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">"response"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"status"</span><span class="err">:</span> <span class="mi">200</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<h2 id="basic-authentication">Basic Authentication</h2>

<p>Although HTTP basic authentication can be supported by requiring a
correctly encoded Authorization header, you can also do this more simply
via the API:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">stubFor</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">"/basic-auth"</span><span class="o">)).</span><span class="na">withBasicAuth</span><span class="o">(</span><span class="s">"user"</span><span class="o">,</span> <span class="s">"pass"</span><span class="o">)</span>
</code></pre>
</div>

<p>Or</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span>
    <span class="s2">"request"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"method"</span><span class="err">:</span> <span class="s2">"GET"</span><span class="p">,</span>
        <span class="s2">"url"</span><span class="err">:</span> <span class="s2">"/basic-auth"</span><span class="p">,</span>
        <span class="s2">"basicAuth"</span> <span class="err">:</span> <span class="p">{</span>
            <span class="s2">"username"</span> <span class="err">:</span> <span class="s2">"user"</span><span class="p">,</span>
            <span class="s2">"password"</span> <span class="err">:</span> <span class="s2">"pass"</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">"response"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"status"</span><span class="err">:</span> <span class="mi">200</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<h2 id="query-parameter-matching">Query parameter matching</h2>

<p>Query parameters can be matched in a similar fashion to headers:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">stubFor</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="n">urlPathEqualTo</span><span class="o">(</span><span class="s">"/with/query"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">withQueryParam</span><span class="o">(</span><span class="s">"search"</span><span class="o">,</span> <span class="n">containing</span><span class="o">(</span><span class="s">"Some text"</span><span class="o">))</span>
        <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">().</span><span class="na">withStatus</span><span class="o">(</span><span class="mi">200</span><span class="o">)));</span>
</code></pre>
</div>

<p>And in JSON:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span>
    <span class="s2">"request"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"method"</span><span class="err">:</span> <span class="s2">"GET"</span><span class="p">,</span>
        <span class="s2">"urlPath"</span><span class="err">:</span> <span class="s2">"/with/query"</span><span class="p">,</span>
        <span class="s2">"queryParameters"</span><span class="err">:</span> <span class="p">{</span>
            <span class="s2">"search"</span><span class="err">:</span> <span class="p">{</span>
                <span class="s2">"contains"</span><span class="err">:</span> <span class="s2">"Some text"</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">"response"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"status"</span><span class="err">:</span> <span class="mi">200</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Note: you must use <code class="highlighter-rouge">urlPathEqualTo</code> or <code class="highlighter-rouge">urlPathMatching</code> to specify the
path, as <code class="highlighter-rouge">urlEqualTo</code> or <code class="highlighter-rouge">urlMatching</code> will attempt to match the whole
request URL, including the query parameters.</p>

<h2 id="request-body-matching">Request body matching</h2>

<p>For PUT and POST requests the contents of the request body can be used
to match stubs:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">stubFor</span><span class="o">(</span><span class="n">post</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">"/with/body"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">withRequestBody</span><span class="o">(</span><span class="n">matching</span><span class="o">(</span><span class="s">"&lt;status&gt;OK&lt;/status&gt;"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">withRequestBody</span><span class="o">(</span><span class="n">notMatching</span><span class="o">(</span><span class="s">".*ERROR.*"</span><span class="o">))</span>
        <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">().</span><span class="na">withStatus</span><span class="o">(</span><span class="mi">200</span><span class="o">)));</span>
</code></pre>
</div>

<p>Body content can be matched using all the same predicates as for
headers: <code class="highlighter-rouge">equalTo</code>, <code class="highlighter-rouge">matching</code>, <code class="highlighter-rouge">notMatching</code>, <code class="highlighter-rouge">containing</code>.</p>

<p>The JSON equivalent of the above example would be:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span>
    <span class="s2">"request"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"method"</span><span class="err">:</span> <span class="s2">"POST"</span><span class="p">,</span>
        <span class="s2">"url"</span><span class="err">:</span> <span class="s2">"/with/body"</span><span class="p">,</span>
        <span class="s2">"bodyPatterns"</span><span class="err">:</span> <span class="p">[</span>
            <span class="p">{</span> <span class="s2">"matches"</span><span class="p">:</span> <span class="s2">"&lt;status&gt;OK&lt;/status&gt;"</span> <span class="p">},</span>
            <span class="p">{</span> <span class="s2">"doesNotMatch"</span><span class="p">:</span> <span class="s2">".*ERROR.*"</span> <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">},</span>
    <span class="s2">"response"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"status"</span><span class="err">:</span> <span class="mi">200</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<h2 id="json-body-matching">JSON body matching</h2>

<p>Body content which is valid JSON can be matched on semantically:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">stubFor</span><span class="o">(</span><span class="n">post</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">"/with/json/body"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">withRequestBody</span><span class="o">(</span><span class="n">equalToJson</span><span class="o">(</span><span class="s">"{ \"houseNumber\": 4, \"postcode\": \"N1 1ZZ\" }"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">().</span><span class="na">withStatus</span><span class="o">(</span><span class="mi">200</span><span class="o">)));</span>
</code></pre>
</div>

<p>By default JSON documents will be matched strictly - array order will matched and extra elements will not be permitted.
However, you can override either of these traits:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="o">.</span><span class="na">withRequestBody</span><span class="o">(</span><span class="n">equalToJson</span><span class="o">(</span><span class="s">"{ \"houseNumber\": 4, \"postcode\": \"N1 1ZZ\" }"</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="kc">true</span><span class="o">))</span>
</code></pre>
</div>

<p>The JSON equivalent of the above example is:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span>
    <span class="s2">"request"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"method"</span><span class="err">:</span> <span class="s2">"POST"</span><span class="p">,</span>
        <span class="s2">"url"</span><span class="err">:</span> <span class="s2">"/with/json/body"</span><span class="p">,</span>
        <span class="s2">"bodyPatterns"</span> <span class="err">:</span> <span class="p">[</span>
            <span class="p">{</span> <span class="s2">"equalToJson"</span> <span class="p">:</span> <span class="s2">"{ \"houseNumber\": 4, \"postcode\": \"N1 1ZZ\" }"</span><span class="p">,</span>
              <span class="s2">"ignoreArrayOrder"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
              <span class="s2">"ignoreExtraElements"</span><span class="p">:</span> <span class="kc">true</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">},</span>
    <span class="s2">"response"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"status"</span><span class="err">:</span> <span class="mi">200</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>JSONPath expressions can also be used:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">stubFor</span><span class="o">(</span><span class="n">post</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">"/with/json/body"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">withRequestBody</span><span class="o">(</span><span class="n">matchingJsonPath</span><span class="o">(</span><span class="s">"$.status"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">withRequestBody</span><span class="o">(</span><span class="n">matchingJsonPath</span><span class="o">(</span><span class="s">"$.things[$(@.name == 'RequiredThing')]"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">().</span><span class="na">withStatus</span><span class="o">(</span><span class="mi">201</span><span class="o">)));</span>
</code></pre>
</div>

<p>The path syntax is implemented by the <a href="http://goessner.net/articles/JsonPath/">JSONPath
library</a>. A JSON body will be
considered to match a path expression if the expression returns either a
non-null single value (string, integer etc.), or a non-empty object or
array.</p>

<p>The JSON equivalent of the above example would be:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span>
    <span class="s2">"request"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"method"</span><span class="err">:</span> <span class="s2">"POST"</span><span class="p">,</span>
        <span class="s2">"url"</span><span class="err">:</span> <span class="s2">"/with/json/body"</span><span class="p">,</span>
        <span class="s2">"bodyPatterns"</span> <span class="err">:</span> <span class="p">[</span>
            <span class="p">{</span> <span class="s2">"matchesJsonPath"</span> <span class="p">:</span> <span class="s2">"$.status"</span><span class="p">},</span>
            <span class="p">{</span> <span class="s2">"matchesJsonPath"</span> <span class="p">:</span> <span class="s2">"$.things[?(@.name == 'RequiredThing')]"</span> <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">},</span>
    <span class="s2">"response"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"status"</span><span class="err">:</span> <span class="mi">201</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<h2 id="xml-body-matching">XML body matching</h2>

<p>As with JSON, XML bodies can be matched on semantically.</p>

<p>In Java:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="o">.</span><span class="na">withRequestBody</span><span class="o">(</span><span class="n">equalToXml</span><span class="o">(</span><span class="s">"&lt;thing&gt;value&lt;/thing&gt;"</span><span class="o">))</span>
</code></pre>
</div>

<p>and in JSON:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="s2">"bodyPatterns"</span> <span class="err">:</span> <span class="p">[</span>
    <span class="p">{</span> <span class="s2">"equalToXml"</span> <span class="p">:</span> <span class="s2">"&lt;thing&gt;value&lt;/thing&gt;"</span> <span class="p">}</span>
<span class="p">]</span>
</code></pre>
</div>

<h2 id="xpath-body-matching">XPath body matching</h2>

<p>Similar to matching on JSONPath, XPath can be used with XML bodies. An
XML document will be considered to match if any elements are returned by
the XPath evaluation.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">stubFor</span><span class="o">(</span><span class="n">put</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">"/xpath"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">withRequestBody</span><span class="o">(</span><span class="n">matchingXPath</span><span class="o">(</span><span class="s">"/todo-list[count(todo-item) = 3]"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">().</span><span class="na">withStatus</span><span class="o">(</span><span class="mi">200</span><span class="o">)));</span>
</code></pre>
</div>

<p>The JSON equivalent of which would be:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span>
    <span class="s2">"request"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"method"</span><span class="err">:</span> <span class="s2">"PUT"</span><span class="p">,</span>
        <span class="s2">"url"</span><span class="err">:</span> <span class="s2">"/xpath"</span><span class="p">,</span>
        <span class="s2">"bodyPatterns"</span> <span class="err">:</span> <span class="p">[</span>
            <span class="p">{</span> <span class="s2">"matchesXPath"</span> <span class="p">:</span> <span class="s2">"/todo-list[count(todo-item) = 3]"</span> <span class="p">},</span>
        <span class="p">]</span>
    <span class="p">},</span>
    <span class="s2">"response"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"status"</span><span class="err">:</span> <span class="mi">200</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>To match XML with namespaced elements the namespaces must be registered:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">stubFor</span><span class="o">(</span><span class="n">put</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">"/namespaced/xpath"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">withRequestBody</span><span class="o">(</span><span class="n">matchingXPath</span><span class="o">(</span><span class="s">"/stuff:outer/stuff:inner[.=111]"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">withXPathNamespace</span><span class="o">(</span><span class="s">"stuff"</span><span class="o">,</span> <span class="s">"http://foo.com"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">().</span><span class="na">withStatus</span><span class="o">(</span><span class="mi">200</span><span class="o">)));</span>
</code></pre>
</div>

<p>or:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span>
    <span class="s2">"request"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"method"</span><span class="err">:</span> <span class="s2">"PUT"</span><span class="p">,</span>
        <span class="s2">"url"</span><span class="err">:</span> <span class="s2">"/xpath"</span><span class="p">,</span>
        <span class="s2">"bodyPatterns"</span> <span class="err">:</span> <span class="p">[</span>
            <span class="p">{</span> <span class="s2">"matchesXPath"</span> <span class="p">:</span> <span class="s2">"/stuff:outer/stuff:inner[.=111]"</span> <span class="p">,</span>
              <span class="s2">"xPathNamespaces"</span> <span class="p">:</span> <span class="p">{</span>
                  <span class="s2">"stuff"</span> <span class="p">:</span> <span class="s2">"http://foo.com/"</span>
              <span class="p">}</span>
            <span class="p">},</span>
        <span class="p">]</span>
    <span class="p">},</span>
    <span class="s2">"response"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"status"</span><span class="err">:</span> <span class="mi">200</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<blockquote>
  <p><strong>note</strong></p>

  <p>All of the request matching options described here can also be used
for <a href="/docs/verifying/">Verifying</a>.</p>
</blockquote>

<h2 id="stub-priority">Stub priority</h2>

<p>It is sometimes the case that you’ll want to declare two or more stub
mappings that “overlap”, in that a given request would be a match for
more than one of them. By default, WireMock will use the most recently
added matching stub to satisfy the request. However, in some cases it is
useful to exert more control.</p>

<p>One example of this might be where you want to define a catch-all stub
for any URL that doesn’t match any more specific cases. Adding a
priority to a stub mapping facilitates this:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c1">//Catch-all case</span>
<span class="n">stubFor</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="n">urlMatching</span><span class="o">(</span><span class="s">"/api/.*"</span><span class="o">)).</span><span class="na">atPriority</span><span class="o">(</span><span class="mi">5</span><span class="o">)</span>
    <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">().</span><span class="na">withStatus</span><span class="o">(</span><span class="mi">401</span><span class="o">)));</span>

<span class="c1">//Specific case</span>
<span class="n">stubFor</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">"/api/specific-resource"</span><span class="o">)).</span><span class="na">atPriority</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="c1">//1 is highest</span>
    <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">()</span>
            <span class="o">.</span><span class="na">withStatus</span><span class="o">(</span><span class="mi">200</span><span class="o">)</span>
            <span class="o">.</span><span class="na">withBody</span><span class="o">(</span><span class="s">"Resource state"</span><span class="o">)));</span>
</code></pre>
</div>

<p>Priority is set via the <code class="highlighter-rouge">priority</code> attribute in JSON:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span>
    <span class="s2">"priority"</span><span class="err">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">"request"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"method"</span><span class="err">:</span> <span class="s2">"GET"</span><span class="p">,</span>
        <span class="s2">"url"</span><span class="err">:</span> <span class="s2">"/api/specific-resource"</span>
    <span class="p">},</span>
    <span class="s2">"response"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"status"</span><span class="err">:</span> <span class="mi">200</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<h2 id="sending-response-headers">Sending response headers</h2>

<p>In addition to matching on request headers, it’s also possible to send response headers:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">stubFor</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">"/whatever"</span><span class="o">))</span>
        <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">()</span>
                <span class="o">.</span><span class="na">withStatus</span><span class="o">(</span><span class="mi">200</span><span class="o">)</span>
                <span class="o">.</span><span class="na">withHeader</span><span class="o">(</span><span class="s">"Content-Type"</span><span class="o">,</span> <span class="s">"application/json"</span><span class="o">)</span>
                <span class="o">.</span><span class="na">withHeader</span><span class="o">(</span><span class="s">"Cache-Control"</span><span class="o">,</span> <span class="s">"no-cache"</span><span class="o">)));</span>
</code></pre>
</div>

<p>Or</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span>
    <span class="s2">"request"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"method"</span><span class="err">:</span> <span class="s2">"GET"</span><span class="p">,</span>
        <span class="s2">"url"</span><span class="err">:</span> <span class="s2">"/whatever"</span>
    <span class="p">},</span>
    <span class="s2">"response"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"status"</span><span class="err">:</span> <span class="mi">200</span><span class="p">,</span>
        <span class="s2">"headers"</span><span class="err">:</span> <span class="p">{</span>
            <span class="s2">"Content-Type"</span><span class="err">:</span> <span class="s2">"text/plain"</span><span class="p">,</span>
            <span class="s2">"Cache-Control"</span><span class="err">:</span> <span class="s2">"no-cache"</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<h2 id="specifying-the-response-body">Specifying the response body</h2>

<p>The simplest way to specify a response body is as a string literal:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">stubFor</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">"/body"</span><span class="o">))</span>
        <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">()</span>
                <span class="o">.</span><span class="na">withBody</span><span class="o">(</span><span class="s">"Literal text to put in the body"</span><span class="o">)));</span>
</code></pre>
</div>

<p>Or</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span>
    <span class="s2">"request"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"method"</span><span class="err">:</span> <span class="s2">"GET"</span><span class="p">,</span>
        <span class="s2">"url"</span><span class="err">:</span> <span class="s2">"/body"</span>
    <span class="p">},</span>
    <span class="s2">"response"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"status"</span><span class="err">:</span> <span class="mi">200</span><span class="p">,</span>
        <span class="s2">"body"</span><span class="err">:</span> <span class="s2">"Literal text to put in the body"</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>To read the body content from a file, place the file under the <code class="highlighter-rouge">__files</code>
directory. By default this is expected to be under <code class="highlighter-rouge">src/test/resources</code>
when running from the JUnit rule. When running standalone it will be
under the current directory in which the server was started. To make
your stub use the file, simply call <code class="highlighter-rouge">bodyFile()</code> on the response builder
with the file’s path relative to <code class="highlighter-rouge">__files</code>:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">stubFor</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">"/body-file"</span><span class="o">))</span>
        <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">()</span>
                <span class="o">.</span><span class="na">withBodyFile</span><span class="o">(</span><span class="s">"path/to/myfile.xml"</span><span class="o">)));</span>
</code></pre>
</div>

<p>Or</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span>
    <span class="s2">"request"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"method"</span><span class="err">:</span> <span class="s2">"GET"</span><span class="p">,</span>
        <span class="s2">"url"</span><span class="err">:</span> <span class="s2">"/body-file"</span>
    <span class="p">},</span>
    <span class="s2">"response"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"status"</span><span class="err">:</span> <span class="mi">200</span><span class="p">,</span>
        <span class="s2">"bodyFileName"</span><span class="err">:</span> <span class="s2">"path/to/myfile.xml"</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<blockquote>
  <p><strong>note</strong></p>

  <p>All strings used by WireMock, including the contents of body files are
expected to be in <code class="highlighter-rouge">UTF-8</code> format. Passing strings in other character
sets, whether by JVM configuration or body file encoding will most
likely produce strange behaviour.</p>
</blockquote>

<p>A response body in binary format can be specified as a <code class="highlighter-rouge">byte[]</code> via an
overloaded <code class="highlighter-rouge">body()</code>:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">stubFor</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="n">urlEqualTo</span><span class="o">(</span><span class="s">"/binary-body"</span><span class="o">))</span>
        <span class="o">.</span><span class="na">willReturn</span><span class="o">(</span><span class="n">aResponse</span><span class="o">()</span>
                <span class="o">.</span><span class="na">withBody</span><span class="o">(</span><span class="k">new</span> <span class="kt">byte</span><span class="o">[]</span> <span class="o">{</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span> <span class="o">})));</span>
</code></pre>
</div>

<p>The JSON API accepts this as a base64 string (to avoid stupidly long
JSON documents):</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span>
    <span class="s2">"request"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"method"</span><span class="err">:</span> <span class="s2">"GET"</span><span class="p">,</span>
        <span class="s2">"url"</span><span class="err">:</span> <span class="s2">"/binary-body"</span>
    <span class="p">},</span>
    <span class="s2">"response"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"status"</span><span class="err">:</span> <span class="mi">200</span><span class="p">,</span>
        <span class="s2">"base64Body"</span> <span class="err">:</span> <span class="s2">"WUVTIElOREVFRCE="</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<h2 id="saving-stubs">Saving stubs</h2>

<p>Stub mappings which have been created can be persisted to the <code class="highlighter-rouge">mappings</code>
directory via a call to <code class="highlighter-rouge">WireMock.saveAllMappings</code> in Java or posting a
request with an empty body to
<code class="highlighter-rouge">http://&lt;host&gt;:&lt;port&gt;/__admin/mappings/save</code>.</p>

<p>Note that this feature is not available when running WireMock from a
servlet container.</p>

<h2 id="removing-stubs">Removing stubs</h2>

<p>Stub mappings which have been created can be removed via <code class="highlighter-rouge">mappings</code>
directory via a call to <code class="highlighter-rouge">WireMock.removeStubMapping</code> in Java or posting
a request with body that has the stub to
<code class="highlighter-rouge">http://&lt;host&gt;:&lt;port&gt;/__admin/mappings/remove</code>.</p>

<p>WireMock tries to match UUID is it is passed in the body of the stup to
a post request and if it finds the stub it removes it. if match is not
found, then it tries to match the request object found in the stub with
existing mappings and removes the first one that it finds.</p>

<p>For Example - posting following stub as body to
<code class="highlighter-rouge">http://&lt;host&gt;:&lt;port&gt;/__admin/mappings/remove</code>. will find first mapping
with request that matches url=”/v8/asd/26”, and method “method”: “GET”.</p>

<div class="highlighter-rouge"><pre class="highlight"><code></code></pre>
</div>

<dl>
  <dt>{</dt>
  <dd>

    <dl>
      <dt>“request”: {</dt>
      <dd>
        <p>“url”: “/v8/asd/26”, “method”: “GET”</p>
      </dd>
    </dl>

    <p>}, “response”: { “status”: 202, “body”: “response for test”,
“headers”: { “Content-Type”: “text/plain” } }</p>
  </dd>
</dl>

<blockquote>
  <p>}</p>
</blockquote>

<p>This is because body does not have UUID. if it had an element like
“uuid”: “aa85aed3-66c8-42bb-a79b-38e3264ff2ef”,in addition to “request”
and “response” then wiremock will remove the one that matches the uuid
provided. removing via uuid has precedence over removing via request
match.</p>

<p>if the remove request UUID does not match with any of the stubs, then it
proceeds to match with request. it will still remove the first stub with
with request match even though UUID did not match/was not provided.</p>

<p>Note that this api only removes one mapping and not multiple ones if
they exist Note that this feature is not available when running WireMock
from a servlet container.</p>

<h2 id="reset">Reset</h2>

<p>The WireMock server can be reset at any time, removing all stub mappings
and deleting the request log. If you’re using either of the JUnit rules
this will happen automatically at the start of every test case. However
you can do it yourself via a call to <code class="highlighter-rouge">WireMock.reset()</code> in Java or
posting a request with an empty body to
<code class="highlighter-rouge">http://&lt;host&gt;:&lt;port&gt;/__admin/reset</code>.</p>

<p>If you’ve created some file based stub mappings to be loaded at startup
and you don’t want these to disappear when you do a reset you can call
<code class="highlighter-rouge">WireMock.resetToDefault()</code> instead, or post an empty request to
<code class="highlighter-rouge">http://&lt;host&gt;:&lt;port&gt;/__admin/mappings/reset</code>.</p>

        
      </section>

      <footer class="page__meta">
        
        




      </footer>

      
    </div>

    
  </article>

  
  
</div>


    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        

<div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    
    
    
    
    
    <li><a href="http://tomakehurst.com/wiremock2/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2016 Tom Akehurst. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>
      </footer>
    </div>

    <script src="http://tomakehurst.com/wiremock2/assets/js/main.min.js"></script>




  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-36386229-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>






  </body>
</html>

